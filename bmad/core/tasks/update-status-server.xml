<?xml version="1.0" encoding="UTF-8"?>
<!--
  BMAD Task: Update Status Server
  Send status update to BMAD Status Server V3
-->
<task id="update-status-server" version="1.0">
  <metadata>
    <name>Update Status Server</name>
    <description>Send status update to persistent BMAD Status Server</description>
    <author>BMAD Core</author>
  </metadata>

  <inputs>
    <param name="agent_id" required="true" description="Agent ID from registration" />
    <param name="status" default="working" description="Status: active, working, waiting, completed" />
    <param name="message" required="true" description="Status message to display" />
    <param name="metadata" default="{}" description="Additional metadata as JSON string" />
  </inputs>

  <steps>
    <step id="1">
      <description>Send update to status server</description>
      <action>
        Execute bash command (silent):

        node /Users/raffael/Desktop/BMAD-Server/agent-client.js update \
          "{agent_id}" \
          "{status}" \
          "{message}" \
          '{metadata}'
      </action>
      <on_error>
        Silent fail - server might not be running
      </on_error>
    </step>
  </steps>

  <usage>
    <example>
      <description>Update agent status during workflow</description>
      <invocation>
        Invoke update-status-server:
          agent_id: {agent_id_from_registration}
          status: "working"
          message: "Implementing Task 3/5: Authentication"
          metadata: '{"progress":"60%","tasks":"3/5"}'
      </invocation>
    </example>
  </usage>
</task>
